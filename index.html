<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>MixMind ‚Äì AI voor DJ's</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Orbitron', sans-serif;
      background-color: #0d0d0d;
      color: #fff;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #111;
      padding: 20px;
      text-align: center;
      font-size: 24px;
      color: #00ffff;
      border-bottom: 1px solid #222;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    .chat-bubble {
      background-color: #1a1a1a;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 15px;
      border-left: 4px solid #00ffff;
    }
    input[type="text"] {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border-radius: 6px;
      border: none;
      margin-top: 10px;
      margin-bottom: 20px;
      background-color: #222;
      color: #fff;
    }
    button {
      padding: 12px 20px;
      background-color: #00ffff;
      color: #000;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      margin: 5px;
    }
    button:hover {
      background-color: #00ff99;
    }
    footer {
      text-align: center;
      padding: 20px;
      font-size: 14px;
      color: #666;
      border-top: 1px solid #222;
    }
  </style>
</head>
<body>
  <header>üéß MixMind ‚Äì AI voor DJ's</header>
  <div class="container">
    <div class="chat-bubble">üëã Welkom bij MixMind! Log eerst in met Spotify:</div>

    <!-- Spotify login -->
    <a href="https://accounts.spotify.com/authorize?client_id=6437dfc0d9314f0c8cff6ff8f68df9df&response_type=token&redirect_uri=https://mixmind.vercel.app/callback&scope=playlist-modify-public playlist-modify-private">
      <button>üîê Log in met Spotify</button>
    </a>

    <!-- Playlist maken -->
    <button onclick="maakPlaylist()">üéß Maak mijn playlist</button>

    <div id="resultaat"></div>
  </div>
  <footer>¬© 2025 MixMind ‚Äì Gebouwd door flor</footer>

  <script>
    async function maakPlaylist() {
      const token = localStorage.getItem("spotify_token");
      if (!token) {
        alert("Je moet eerst inloggen met Spotify.");
        return;
      }

      const genre = prompt("Welk genre wil je in je playlist?");
      if (!genre) return;

      // Haal gebruikers-ID op
      const userRes = await fetch("https://api.spotify.com/v1/me", {
        headers: { Authorization: `Bearer ${token}` }
      });
      const userData = await userRes.json();
      const userId = userData.id;

      // Maak playlist
      const playlistRes = await fetch(`https://api.spotify.com/v1/users/${userId}/playlists`, {
        method: "POST",
        headers: {
          Authorization: `Bearer ${token}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          name: `MixMind ‚Äì ${genre}`,
          description: `Automatisch gegenereerde playlist voor ${genre}`,
          public: false
        })
      });

      const playlistData = await playlistRes.json();
      const playlistUrl = playlistData.external_urls.spotify;

      document.getElementById("resultaat").innerHTML = `
        <div class="chat-bubble">
          ‚úÖ Playlist aangemaakt:<br>
          <a href="${playlistUrl}" target="_blank">${playlistUrl}</a>
        </div>
      `;
    }
  </script>
</body>
</html>
